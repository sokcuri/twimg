import{f as e}from"./vendor.f22c6d37.js";const t=document.querySelector("#app"),n=document.querySelector("#app > .img-store");function r(e){var t;const n=null==e?void 0:e.getData("text/html");if(0===(null==n?void 0:n.indexOf("<img"))){let e=null==(t=/<img[^>]+src="([^">]+)"/.exec(n))?void 0:t[1];return 0===(null==e?void 0:e.indexOf("blob:"))?null:e}return null}async function a(t){const r=document.createElement("img"),a=new URL(t.replace(/&amp;/g,"&"));let o="";for(let e of a.searchParams){o+=""===o?"?":"&";let t=e[0],n=e[1];switch(t){case"name":n="large"}o+=t+"="+n}t=a.origin+a.pathname+o,r.src=t,n.prepend(r);const i=await async function(e){return new Promise((async t=>{const n=await fetch(e);t(await n.blob())}))}(t),d=function(e){switch(e){case"image/bmp":return".bmp";case"image/gif":return".gif";case"image/jpeg":return".jpg";case"image/png":return".png";case"image/svg+xml":return".svg";case"image/tiff":return".tif";case"image/webp":return".webp"}return null}(i.type);if(!d)return;const s=URL.createObjectURL(i);r.src=s;let c=t.substr(t.lastIndexOf("/")+1);c=c.substr(0,c.indexOf("?")),c=c.substr(c.indexOf(".")+1);try{await e(i,{fileName:c,extensions:[d]})}catch(l){n.removeChild(r)}}async function o(e){const t=await async function(e){return new Promise((t=>{const n=new OffscreenCanvas(e.naturalWidth,e.naturalHeight);n.getContext("2d").drawImage(e,0,0),t(n.convertToBlob({type:"image/png"}))}))}(e),n=navigator.clipboard,r=window.ClipboardItem;try{n.write([new r({"image/png":t})])}catch(a){console.error(a)}}document.body.addEventListener("dragstart",(e=>{var n;r(e.dataTransfer)||(t.style.border=""),null==(n=e.dataTransfer)||n.clearData()}),!1),document.body.addEventListener("dragend",(e=>{t.style.border=""})),document.body.addEventListener("dragenter",(e=>{t.style.border="2px dashed #000",r(e.dataTransfer),e.preventDefault()}),!1),document.body.addEventListener("dragleave",(e=>{t.style.border="",e.preventDefault()})),document.body.addEventListener("dragover",(e=>{t.style.border="2px dashed #000",e.preventDefault()}),!1),document.body.addEventListener("drop",(async e=>{var n;t.style.border="",e.preventDefault();const r=function(e){const t={},n=e.types;for(let r of n)t[r]=null==e?void 0:e.getData(r);return t}(e.dataTransfer);if(r["text/html"]&&0===r["text/html"].indexOf("<img")){let e=null==(n=/<img[^>]+src="([^">]+)"/.exec(r["text/html"]))?void 0:n[1];if(0===(null==e?void 0:e.indexOf("blob:")))return;if(0!==(null==e?void 0:e.indexOf("https://pbs.twimg.com/")))return;e&&await a(e)}console.log(e.dataTransfer)}),!1),n.addEventListener("click",(async e=>{"IMG"===e.target.tagName&&await o(e.target)}),!1);
